<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
  <title>文章详情</title>
  <link rel="stylesheet" href="./css/reset.css">
  <link rel="stylesheet" href="./css/shartArt.css">
  <!-- <link rel="stylesheet" href="./css/swiper-3.4.2.min.css"> -->
  <script src="./js/jquery-2.2.1.min.js"></script>
  <!-- <script src="./js/swiper-3.4.2.jquery.min.js"></script> -->
</head>
<body>
  <div class="main">
    <div class="swiper-img"></div>
    <div class="swiper-container">
      <div class="swiper-wrapper">
        <div class="swiper-slide">
      <!-- 轮播公告轮播公告轮播公告轮播公告轮播公告轮播公告 -->
        </div>
      </div>
    </div>
    <div class="top">
      <div class="logo">
        <img src="./image/share_app_logo.png" alt="">
      </div>
      <div class="appMessage">
        <h2>赖氏风采</h2>
        <span>古赖国文化研究院官方平台</span>
      </div>
      <div class="downLoadBtn" id="downloadButton">
        <span>打开APP</span>
        <img src="./image/app_netx_icon_b.png" alt="">
      </div>
    </div>
    <h1 class="mainTitle"></h1>
    <div class="titleArt">
      <span class="titName"></span>
      <span class="titTime"></span>
    </div>
    <div class="articleMain">
      <!-- 2020年1月8日下午，惠东赖氏宗亲联谊会2019年度
      年终总结大会在白盆珠镇白盆湖温泉度假村召开。<br><br><br>县宗亲会班子成员，十大片区正副理事长，《惠东赖氏族谱》编辑部、会所工作人员，以及特邀宗贤共80多人参加了大会。当天大会的议程共有七项： <br>
      一、白盆珠片区副理事长赖爱忠致欢迎辞； <br>二、常务副会长赖玉忠讲话； <br>三、常务理事、族谱主编赖银鹰讲话； <br>四、常务理事、会计赖金培作财务工作报告； <br>五、常务理事、监事长赖文龙讲话；、常务副会长赖润忠讲话； <br>七、会长赖华作年终工作总结讲话。 -->
    </div>
    <!-- <div class="articleImg">
      <img src="" alt="">
    </div> -->
    <div class="comment">
      <div class="commitTop">
        评论详情
      </div>
      <div class="commitStart">
      <!-- <div class="commitMain">
        <div class="commitAva">
          <div class="headIcon">
            <img src="" alt="">
          </div>
          <div class="commitIntro">
            <h3>不一样的烟火</h3>
            <span>2020-01-12</span>
          </div>
          <div class="commitLike">
            <div class="lickIcon"></div>
            <div class="likeNum liken1">0</div>
          </div>
        </div>
        <div class="commitart">
          <div class="commitContent">建设古赖国文化园，人人添砖加瓦出一份力。</div>
          <div class="huifu">
            <ul>
              <li class="huifuItem">
                <span class="username">用户13714779006</span><span class="hf">回复</span><span class="byUsername">赖运运</span>
                <span class="huifuContent">:加油，奥利给。</span>
              </li>
              <li class="huifuItem">
                <span class="username">用户13714779006</span><span class="hf">回复</span><span class="byUsername">赖运运</span>
                <span class="huifuContent">:加油，奥利给。</span>
              </li>
              <li class="huifuItem">
                <span class="username">查看全部回复>></span>
              </li>
            </ul>
          </div>
          <div class="commitdelete">
            <span>删除</span>
          </div>
        </div>
      </div> -->
      <!-- <div class="commitMain commit2">
        <div class="commitAva">
          <div class="headIcon">
            <img src="" alt="">
          </div>
          <div class="commitIntro">
            <h3>不一样的烟火</h3>
            <span>2020-01-12</span>
          </div>
          <div class="commitLike">
            <div class="lickIcon"></div>
            <div class="likeNum liken2">0</div>
          </div>
        </div>
        <div class="commitart">
          <div class="commitContent">建设古赖国文化园，人人添砖加瓦出一份力。</div>
          <div class="huifu">
            <ul>
              <li class="huifuItem">
                <span class="username">用户13714779006</span><span class="hf">回复</span><span class="byUsername">赖运运</span>
                <span class="huifuContent">:加油，奥利给。</span>
              </li>
              <li class="huifuItem">
                <span class="username">用户13714779006</span><span class="hf">回复</span><span class="byUsername">赖运运</span>
                <span class="huifuContent">:加油，奥利给。</span>
              </li>
              <li class="huifuItem">
                <span class="username">查看全部回复>></span>
              </li>
            </ul>
          </div>
          <div class="commitdelete">
            <span>删除</span>
          </div>
        </div>
      </div> -->
    </div>
      <div class="btnApp">
          APP内查看全部评论
      </div>
      <div class="commitRelease">
        <div class="commitInput">欢迎发布您的评论</div>
        <div class="like">
          <div class="likeIcon"></div>
          <div class="likeNum airLike"></div>
        </div>
      </div>
    </div>
  </div>
</body>
<script>
  var url=window.location.href;
  // var url="www.********.com/redict?id=62";
  var list1=url.split("?")[1].split("&");
  var object={};
  for(var i=0;i<list1.length;i++){
    var list2=list1[i].split("=");
    object[list2[0]]=list2[1];
  }
  var id=object.id;
  console.log(id);
  //获取文章内容详情
  $.ajax({
    type: "POST",
    url: "http://47.107.81.81:177/laishitoutiao/api/wenHuaYuan/getByArticleId",
    data: {
      id:parseInt(id)
    },
    dataType: "json",
    success: function (res) {
      if(res.code==1){
        var data=res.data;
        var regex = new RegExp('<img', 'gi');
        txt = data.text.replace(regex, '<img style="width: 100%; height:auto"');
        $(".mainTitle").text(data.articletitle);
        $(".titName").text(data.name);
        $(".titTime").text(data.createTime);
        $(".articleMain").html(txt);
        $(".articleImg img").attr("src","https://laishifengcai.oss-cn-shenzhen.aliyuncs.com"+data.coverimg)
        $(".airLike").text(data.zanNum)
      }else{
        alert("数据获取失败")
      }
    }
  });
  //获取评论列表
  $.ajax({
    type: "post",
    url: "http://47.107.81.81:177/laishitoutiao/api/topic/pageComment",
    data: {
      articleId:id,
      hot:1
    },
    dataType: "json",
    success: function (res) {
      if(res.code==1){
        var list=res.data.list;
        console.log(list)
        var Html="";
        for(var i=0;i<2;i++){
          var html2="";
          var length=list[i].secondList.length;
          for(var j=0;j<length;j++){
              html2=html2+"<li class='huifuItem'><span class='username'>"+list[i].secondList[j].userName+"</span><span class='hf'>回复</span><span class='byUsername'>"+list[i].secondList[j].byUserName+"</span><span class='huifuContent'>:"+list[i].secondList[j].content+"</span></li>"
          }
          Html=Html+"<div class='commitMain'><div class='commitAva'><div class='headIcon'><img src='https://laishifengcai.oss-cn-shenzhen.aliyuncs.com"+list[i].avatar+"' alt=''></div><div class='commitIntro'><h3>"+list[i].userName+"</h3><span>"+list[i].createTime+"</span></div><div class='commitLike'><div class='lickIcon'></div><div class='likeNum liken1'>"+list[i].zanNum+"</div></div></div><div class='commitart'><div class='commitContent'>"+list[i].content+"</div><div class='huifu'><ul>"+html2+"<li class='huifuItem'><span class='username'>查看全部回复>></span></li></ul></div><div class='commitdelete'><span>删除</span></div></div></div>"
        }
        $('.commitStart').html(Html);
      }else{
        alert("评论数据获取失败")
      }
    }
  });
  //获取页面轮播公告
  $.ajax({
    type: "post",
    url: "http://47.107.81.81:177/laishitoutiao/api/content1/get",
    data: {
      id:5
    },
    dataType: "json",
    success: function (res) {
      var notice=res.data.content;
      $('.swiper-slide').html(notice);

      //进行轮播
      // 1.获取轮播内容的宽度
      var $p=$(".swiper-slide p");
      var Width=$(".swiper-slide p").outerWidth();
      var offsetLeft=$(".swiper-slide p").offset().left;
      console.log(Width,offsetLeft);
      var timer=setInterval(function(){
        offsetLeft=offsetLeft-1
        $p.offset({left:offsetLeft});
        if(-offsetLeft>Width){
          offsetLeft=375;
        }
      },15)
    }
  });

</script>
<script type="text/javascript" charset="UTF-8" src="https://web.cdn.openinstall.io/openinstall.js"></script>
<script type="text/javascript">
    //OpenInstall初始化时将与OpenInstall服务器交互，应尽可能早的调用
    /*web页面向app传递的json数据(json string/js Object)，应用被拉起或是首次安装时，通过相应的android/ios api可以获取此数据*/
    var data = OpenInstall.parseUrlParams();///openinstall.js中提供的工具函数，解析url中的所有查询参数
    new OpenInstall({
        /*appKey必选参数，OpenInstall平台为每个应用分配的ID*/
        appKey : "xit2up",
        /*可选参数，自定义android平台的apk下载文件名；个别andriod浏览器下载时，中文文件名显示乱码，请慎用中文文件名！*/
        //apkFileName : 'com.example-v2.2.0.apk',
        /*可选参数，是否优先考虑拉起app，以牺牲下载体验为代价*/
        // preferWakeup:true,
        /*自定义遮罩的html*/
        //mask:function(){
        //  return "<div id='_shadow' style='position:fixed;left:0;top:0;background:rgba(0,255,0,0.5);filter:alpha(opacity=50);width:100%;height:100%;z-index:10000;'></div>"
        //},
        /*OpenInstall初始化完成的回调函数，可选*/
        onready : function() {
            /*在app已安装的情况尝试拉起app*/
            // this.downloadButton;
            
            /*用户点击某个按钮时(假定按钮id为downloadButton)，安装app*/
            var m = this, button = document.getElementById("downloadButton");
            button.style.visibility = "visible";
            button.onclick = function() {
              //先尝试拉起app再安装
                m.downloadButton;
                m.wakeupOrInstall();
                return false;
            }
            $(".btnApp").on("click",function(){
              //先尝试拉起app再安装
                m.downloadButton;
                m.wakeupOrInstall();
                return false;
            })
        }
    }, data);

</script>
</script>
</html>